{"uid":"8726b7711f9e2a6a","name":"test_register[case_info0]","fullName":"test_cases.test_register.test_register.TestRegister#test_register","historyId":"97d973322e62e2f042cda997571f1734","time":{"start":1766840340237,"stop":1766840340336,"duration":99},"status":"broken","statusMessage":"FileNotFoundError: 数据库文件未找到，请检查路径: D:\\Workspace\\flask-project\\flask_app\\instance\\app.db","statusTrace":"self = <test_register.TestRegister object at 0x7f7aac9473d0>\ncase_info = {'case_name': '新用户注册测试', 'request': {'json': {'email': 'panxia@example.com', 'password': '123456', 'username': 'user_2192'}, 'method': 'post', 'url': '/auth/register'}, 'validate': {'message': '注册成功', 'status_code': 201}}\n\n    @allure.story(\"用户注册接口\")\n    @pytest.mark.parametrize(\"case_info\", data_list)\n    def test_register(self, case_info):\n        url = case_info['request']['url']\n        method = case_info['request']['method']\n        json_data = case_info['request']['json']\n    \n        # 发送请求\n        req = RequestUtil()\n        res = req.send_request(method=method, url=url, json=json_data)\n        result = res.json()\n    \n        # 断言验证结果\n        assert res.status_code == case_info['validate']['status_code']\n        assert case_info['validate']['message'] in result['message']\n    \n        # 数据库断言\n        # 获取刚才请求中的用户名（注意：如果是热加载生成的，这里需要技巧）\n        # 简化处理：我们在 register_data.yaml 里使用了热加载。\n        # 在这里，json_data 已经是被 YamlUtil 替换过实际值的字典了，可以直接取！\n        target_username = json_data['username']\n        target_email = json_data['email']\n    \n        print(f\"正在数据库中查询用户: {target_username}\")\n        sql = f\"SELECT * FROM user WHERE username = '{target_username}'\"\n    \n>       db_res = DBUtil().query_one(sql)\n\ntest_cases/test_register/test_register.py:39: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <common.db_util.DBUtil object at 0x7f7aac5a64a0>\n\n    def __init__(self):\n        # 1. 从配置文件读取数据库路径\n        config = YamlUtil.read_config()\n        self.db_path = config['env']['db_path']\n    \n        # 检查文件是否存在，防止报错一脸懵\n        if not os.path.exists(self.db_path):\n>           raise FileNotFoundError(f\"数据库文件未找到，请检查路径: {self.db_path}\")\nE           FileNotFoundError: 数据库文件未找到，请检查路径: D:\\Workspace\\flask-project\\flask_app\\instance\\app.db\n\ncommon/db_util.py:15: FileNotFoundError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1766840339915,"stop":1766840339977,"duration":62},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"excute_database_clear","time":{"start":1766840339978,"stop":1766840339978,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"login_finture","time":{"start":1766840339978,"stop":1766840340072,"duration":94},"status":"passed","steps":[],"attachments":[{"uid":"5ec68bebd1c60d7c","name":"请求信息","source":"5ec68bebd1c60d7c.txt","type":"text/plain","size":122},{"uid":"8550068ff534238c","name":"响应信息","source":"8550068ff534238c.txt","type":"text/plain","size":491}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"FileNotFoundError: 数据库文件未找到，请检查路径: D:\\Workspace\\flask-project\\flask_app\\instance\\app.db","statusTrace":"self = <test_register.TestRegister object at 0x7f7aac9473d0>\ncase_info = {'case_name': '新用户注册测试', 'request': {'json': {'email': 'panxia@example.com', 'password': '123456', 'username': 'user_2192'}, 'method': 'post', 'url': '/auth/register'}, 'validate': {'message': '注册成功', 'status_code': 201}}\n\n    @allure.story(\"用户注册接口\")\n    @pytest.mark.parametrize(\"case_info\", data_list)\n    def test_register(self, case_info):\n        url = case_info['request']['url']\n        method = case_info['request']['method']\n        json_data = case_info['request']['json']\n    \n        # 发送请求\n        req = RequestUtil()\n        res = req.send_request(method=method, url=url, json=json_data)\n        result = res.json()\n    \n        # 断言验证结果\n        assert res.status_code == case_info['validate']['status_code']\n        assert case_info['validate']['message'] in result['message']\n    \n        # 数据库断言\n        # 获取刚才请求中的用户名（注意：如果是热加载生成的，这里需要技巧）\n        # 简化处理：我们在 register_data.yaml 里使用了热加载。\n        # 在这里，json_data 已经是被 YamlUtil 替换过实际值的字典了，可以直接取！\n        target_username = json_data['username']\n        target_email = json_data['email']\n    \n        print(f\"正在数据库中查询用户: {target_username}\")\n        sql = f\"SELECT * FROM user WHERE username = '{target_username}'\"\n    \n>       db_res = DBUtil().query_one(sql)\n\ntest_cases/test_register/test_register.py:39: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <common.db_util.DBUtil object at 0x7f7aac5a64a0>\n\n    def __init__(self):\n        # 1. 从配置文件读取数据库路径\n        config = YamlUtil.read_config()\n        self.db_path = config['env']['db_path']\n    \n        # 检查文件是否存在，防止报错一脸懵\n        if not os.path.exists(self.db_path):\n>           raise FileNotFoundError(f\"数据库文件未找到，请检查路径: {self.db_path}\")\nE           FileNotFoundError: 数据库文件未找到，请检查路径: D:\\Workspace\\flask-project\\flask_app\\instance\\app.db\n\ncommon/db_util.py:15: FileNotFoundError","steps":[],"attachments":[{"uid":"1df1394500d93240","name":"请求信息","source":"1df1394500d93240.txt","type":"text/plain","size":156},{"uid":"7a8af2c1164fdb6d","name":"响应信息","source":"7a8af2c1164fdb6d.txt","type":"text/plain","size":265},{"uid":"27186b5f9ed2f9d2","name":"log","source":"27186b5f9ed2f9d2.txt","type":"text/plain","size":729}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":3,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"story","value":"用户注册接口"},{"name":"epic","value":"Flask商城接口测试"},{"name":"feature","value":"用户注册模块"},{"name":"parentSuite","value":"test_cases.test_register"},{"name":"suite","value":"test_register"},{"name":"subSuite","value":"TestRegister"},{"name":"host","value":"runnervmh13bl"},{"name":"thread","value":"2555-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"test_cases.test_register.test_register"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"case_info","value":"{'case_name': '新用户注册测试', 'request': {'method': 'post', 'url': '/auth/register', 'json': {'username': 'user_2192', 'email': 'panxia@example.com', 'password': '123456'}}, 'validate': {'status_code': 201, 'message': '注册成功'}}"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"8726b7711f9e2a6a.json","parameterValues":["{'case_name': '新用户注册测试', 'request': {'method': 'post', 'url': '/auth/register', 'json': {'username': 'user_2192', 'email': 'panxia@example.com', 'password': '123456'}}, 'validate': {'status_code': 201, 'message': '注册成功'}}"]}